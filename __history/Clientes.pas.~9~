unit Clientes;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Data.DB, Vcl.DBCtrls, Vcl.Mask,
  Vcl.StdCtrls, Vcl.Buttons, Vcl.ExtCtrls, Vcl.Grids, Vcl.DBGrids, Vcl.ComCtrls,
  FireDAC.Stan.Intf, FireDAC.Stan.Option, FireDAC.Stan.Param,
  FireDAC.Stan.Error, FireDAC.DatS, FireDAC.Phys.Intf, FireDAC.DApt.Intf,
  FireDAC.Stan.Async, FireDAC.DApt, FireDAC.Comp.DataSet, FireDAC.Comp.Client;

type
  TFClientes = class(TForm)
    PageProdutos: TPageControl;
    TabListagem: TTabSheet;
    DBGrid1: TDBGrid;
    Panel2: TPanel;
    Label4: TLabel;
    EdPesquisa: TEdit;
    BtPesquisar: TBitBtn;
    BtLimparPesquisa: TBitBtn;
    BtListagemNovo: TBitBtn;
    BtAtualizarListagem: TBitBtn;
    Panel3: TPanel;
    TabCadastro: TTabSheet;
    Panel1: TPanel;
    Label1: TLabel;
    Label2: TLabel;
    EdCodigo: TDBEdit;
    EdNome: TDBEdit;
    BtExcluir: TBitBtn;
    BtCancelar: TBitBtn;
    BtEditar: TBitBtn;
    BtSalvar: TBitBtn;
    BtNovo: TBitBtn;
    BtAtualizar: TBitBtn;
    Panel4: TPanel;
    QryListagem: TFDQuery;
    DsListagem: TDataSource;
    GroupBox1: TGroupBox;
    Label5: TLabel;
    EdLogradouro: TDBEdit;
    Label6: TLabel;
    EdNumero: TDBEdit;
    Label7: TLabel;
    EdBairro: TDBEdit;
    Label8: TLabel;
    EdCidade: TDBEdit;
    Label9: TLabel;
    EdCep: TDBEdit;
    Label10: TLabel;
    EdUf: TDBEdit;
    QryClientes: TFDQuery;
    DsClientes: TDataSource;
    QryClientesCLIENTE_CODIGO: TIntegerField;
    QryClientesCLIENTE_NOME: TStringField;
    QryClientesCLIENTE_CPF: TStringField;
    QryClientesCLIENTE_LOGRADOURO: TStringField;
    QryClientesCLIENTE_ENDERECO_NUMERO: TStringField;
    QryClientesCLIENTE_BAIRRO: TStringField;
    QryClientesCLIENTE_CIDADE: TStringField;
    QryClientesCLIENTE_CEP: TStringField;
    QryClientesCLIENTE_UF: TStringField;
    EdCpf: TDBEdit;
    Label3: TLabel;
    procedure FormClose(Sender: TObject; var Action: TCloseAction);
    procedure FormCreate(Sender: TObject);
    procedure FormShow(Sender: TObject);
    procedure DBGrid1DblClick(Sender: TObject);
    procedure BtLimparPesquisaClick(Sender: TObject);
    procedure BtEditarClick(Sender: TObject);
    procedure TabCadastroShow(Sender: TObject);
  private
    { Private declarations }
  public
    { Public declarations }
  end;

var
  FClientes: TFClientes;
  SqlListagem: string;

implementation

{$R *.dfm}

uses DataModule, Principal;

procedure TFClientes.BtEditarClick(Sender: TObject);
begin
  QryClientes.Edit;
end;

procedure TFClientes.BtLimparPesquisaClick(Sender: TObject);
begin
  EdPesquisa.Text := '';
  EdPesquisa.SetFocus;
end;

procedure TFClientes.DBGrid1DblClick(Sender: TObject);
begin
  PageProdutos.ActivePage := TabCadastro;
end;

procedure TFClientes.FormClose(Sender: TObject; var Action: TCloseAction);
begin
  QryListagem.Close;
  action := caFree;
  FClientes := nil;
end;

procedure TFClientes.FormCreate(Sender: TObject);
begin
  PageProdutos.ActivePage := TabListagem;
  SqlListagem := 'SELECT c.* FROM CLIENTES c ';
end;

procedure TFClientes.FormShow(Sender: TObject);
begin
  QryListagem.Open();
end;

procedure TFClientes.TabCadastroShow(Sender: TObject);
begin
  QryClientes.Close;
  QryClientes.ParamByName('CODIGO').AsInteger := QryListagem.FindField('CLIENTE_CODIGO').AsInteger;
  QryClientes.Open;
  EdNome.SetFocus;
end;

end.
